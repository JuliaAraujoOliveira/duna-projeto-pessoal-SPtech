<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/imgs/ico-logo.svg" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Newvison | Home</title>


    <link rel="stylesheet" href="./../css/dashboards.css">
    <link rel="stylesheet" href="./../css/estilo.css" />


    <script src="../js/sessao.js"></script>
    <script src="../js/alerta.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
</head>

<body onload="validarSessao(),atualizarFeed()">

    <div class="janela">

        <div class="header-left dash-header">

            <img src="../assets/imgs/logo.svg" style="width:20vw;">

            <div class="hello">
                <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
            </div>

            <div class="btn-nav-white">
                <h3>Home</h3>
            </div>

            <div class="btn-nav">
                <a href="./mural.html">
                    <h3>Perfil</h3>
                </a>
            </div>
            <div class="btn-nav">
                <a href="./config.html">
                    <h3>Config</h3>
                </a>
            </div>

            <div class="btn-nav">
                <a href="./dashboard.html">
                    <h3>Dash</h3>
                </a>
            </div>



            <div class="btn-logout" onclick="limparSessao()">
                <a href="../index.html"></a>
                <h3>Sair</h3>
            </div>

        </div>


        <div class="cards" id="cardAquarios">
            <div class="div-results">
                <div id="feed_container" class="feed-container" style="display: flex; justify-content: center; flex-direction: column; align-items: center;">
                </div>
            </div>

        </div>





    </div>

    </div>

</body>

<script>

    // function exibirAquarios() {





    //     JSON.parse(sessionStorage.AQUARIOS).forEach(item => {
    //         document.getElementById("cardAquarios").innerHTML += `
    //                 <div class="card-aquario">
    //                     <div class="title-aquario">
    //                         <h1>${item.descricao}</h1>
    //                     </div>
    //                     <div class="desc-aquario">
    //                     <div class="temperatura">
    //                         <p id="temp_aquario_${item.id}">-°C</p>
    //                     </div>
    //                     <div class="cor-alerta" id="card_${item.id}"></div>
    //                 </div>
    //                 </div>
    //                 `
    //     });
    // }



    function atualizarFeed() {
        fetch("/avisos/listar").then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var feed = document.getElementById("feed_container");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    feed.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    var feed = document.getElementById("feed_container");
                    feed.innerHTML = "";
                    for (let i = 0; i < resposta.length; i++) {
                        var publicacao = resposta[i];



                        // criando e manipulando elementos do HTML via JavaScript
                        var divPublicacao = document.createElement("div");
                        var spanID = document.createElement("span");
                        var spanTitulo = document.createElement("span");
                        var spanNome = document.createElement("span");
                        var divDescricao = document.createElement("div");
                        var divButtons = document.createElement("div");
                        var btnEditar = document.createElement("button");
                        var btnDeletar = document.createElement("button");




                        feed_container.innerHTML += ` 
                        <div class="publica">
                            <div class="info-autora"><img src="../assets/foto-autora.jpeg" alt="Julia Araujo"> <span>@JuliaAraujo</span></div>
                                <div class="desc-publi">
                                    <div class="conteudo">
                                        <div class="titulo" id="titulo">${publicacao.titulo} </div>
                                            <div class="desc">${publicacao.descPublicacao}</div>
                                            <div class="comentarios">
                                                 <i class="fa-regular fa-comment">Comentários</i>
                                                </div>
                                </div>
                            </div>
                         </div>`

                        // spanID.innerHTML = "ID: <b>" + publicacao.idAviso + "</b>";
                        // spanTitulo.innerHTML = "Título: <b>" + publicacao.titulo + "</b>";
                        // spanNome.innerHTML = "Autor: <b>" + publicacao.nome + "</b>";
                        // divDescricao.innerHTML = "Descrição: <b>" + publicacao.descPublicacao + "</b>";


                        // divPublicacao.className = "publicacao";
                        // spanTitulo.id = "inputNumero" + publicacao.idAviso;
                        // spanNome.className = "publicacao-nome";
                        // spanTitulo.className = "publicacao-titulo";
                        // divDescricao.className = "publicacao-descricao";


                        divPublicacao.appendChild(spanID);
                        divPublicacao.appendChild(spanNome);
                        divPublicacao.appendChild(spanTitulo);
                        divPublicacao.appendChild(divDescricao);
                        feed.appendChild(divPublicacao);
                    }

                    // finalizarAguardar();
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
            // finalizarAguardar();
        });
    }

</script>

</html>